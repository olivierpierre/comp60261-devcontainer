#include <stdio.h>
#include <stdlib.h>

// usage: USER_INPUT=pierre ./environment-variable
int main(int argc, char *argv[]) {
    char *user = getenv("USER_INPUT");
    if (!user) {
        fprintf(stderr, "Please set the USER_INPUT environment variable.\n");
        return 1;
    }

    char buffer[100];

    // Vulnerable: format string comes from environment variable
    snprintf(buffer, sizeof(buffer), user);

    printf("Hello, ");
    puts(buffer);

    return 0;
}